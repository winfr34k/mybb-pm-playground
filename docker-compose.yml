---
services:
  mybb:
    image: mybb/mybb:latest
    volumes:
      - ${PWD}/wwwroot:/var/www/html:rw
      - ${PWD}/conf/config.php:/var/www/html/inc/config.php:ro
      - ${PWD}/conf/lock:/var/www/html/install/lock:ro

  nginx:
    image: nginx:mainline-alpine
    ports:
      - published: 8080
        target: 80
    volumes:
      - ${PWD}/conf/nginx_mybb.conf:/etc/nginx/conf.d/default.conf:ro
      - ${PWD}/wwwroot:/var/www/html:ro

  mariadb:
    image: mariadb:11.3
    environment:
      MARIADB_ROOT_PASSWORD: changeme
      MARIADB_DATABASE: mybb
    volumes:
      - ${PWD}/conf/initial_with_pms.sql:/docker-entrypoint-initdb.d/99-init.sql:ro

  phpmyadmin:
    image: phpmyadmin:5
    environment:
      PMA_HOST: mariadb
      PMA_USER: root
      PMA_PASSWORD: changeme
    ports:
      - published: 8081
        target: 80

